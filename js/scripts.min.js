$(function() {

	// Custom JS
  $('.menu-btn').on('click', function(e) {
    e.preventDefault;
    $(this).toggleClass('menu-btn_active');
    $('.menu-resp ul').toggleClass('open');
    if ($('.menu-resp ul').hasClass('open')) {
      if (screen.width <= '577') {
        $('.menu-resp ul').width(screen.width - 40);
        $('.menu-resp ul').css('right', -15);
      }
      $('.menu-resp ul').slideDown();
    } else {
      $('.menu-resp ul').slideUp();
    }
  });
  
  $('.tabs').tabulous();
  
  $('.input select').niceSelect();
  
  $('.extended-search select').niceSelect();
  
  if ($('*').is('script[src*="jquery-ui"]')) {
    $( ".slider-range" ).slider({
      range: true,
      min: 0,
      max: 200000,
      values: [ 100000, 150000 ]
    });
  }
  
  $('.arrow').click(function () {
    $(this).parent('.quest').toggleClass('active');
    if ($(this).parent('.quest').hasClass('active')) {
      $(this).children('span').removeClass('fa-angle-down').addClass('fa-angle-up');
      $(this).parent('.quest').next().slideDown('fast');
    } else {
      $(this).children('span').removeClass('fa-angle-up').addClass('fa-angle-down');
      $(this).parent('.quest').next().slideUp('fast');
    }
  });

  $('.opportunities-slider').slick({
    prevArrow: $('.opportunities-control-left span'),
    nextArrow: $('.opportunities-control-right span'),
    slidesToShow: 1
  });
  
  $('.slider').slick({
    prevArrow: $('.control-left span'),
    nextArrow: $('.control-right span'),
    slidesToShow: 2,
    responsive: [
    {
      breakpoint: 769,
      settings: {
        slidesToShow: 1,
      }
    }]
  });
  
  $('#about-info .slider-wrap').slick({
    prevArrow: $('#about-info .control-left span'),
    nextArrow: $('#about-info .control-right span'),
    slidesToShow: 3,
    slidesToScroll: 3,  
    responsive: [
        {
          breakpoint: 1110,
          settings: {
            slidesToShow: 2,
            slidesToScroll: 2
          }
        },
        {
          breakpoint: 520,
          settings: {
            slidesToShow: 1,
            slidesToScroll: 1
          }
        }
      ]
  });

  $('#sertificate-info .slider-wrap').slick({
    prevArrow: $('#sertificate-info .control-left span'),
    nextArrow: $('#sertificate-info .control-right span'),
    slidesToShow: 1
  });

  $(window).scroll(function () {
    if ($(this).scrollTop() > 630) {
      $('.sidebar-info').addClass('fixed-sidebar');
    }
    else{
      $('.sidebar-info').removeClass('fixed-sidebar');
    }
  });

  $(window).scroll(function () {
    if ($(this).scrollTop() > 100) {
      $('.sidebar-registration').addClass('fixed-sidebar');
    }
    else{
      $('.sidebar-registration').removeClass('fixed-sidebar');
    }
  });

  $(function () {
      $('a[href*="#"]:not([href="#"])').click(function () {
          if (location.pathname.replace(/^\//, '') === this.pathname.replace(/^\//, '') && location.hostname === this.hostname) {
              var target = $(this.hash);
              target = target.length ? target : $('[name=' + this.hash.slice(1) + ']');
          }
      });
  });
  $(document).ready(function () {
   
      function Scroll_block(){
          var scroll_top = $(document).scrollTop();
          $(".sidebar-info a").each(function(){
              var hash = $(this).attr("href");
              var target = $(hash);
              if (target.position().top <= scroll_top && target.position().top + target.outerHeight() > scroll_top) {
                  $(".sidebar-info li.sidebar-registration-active").parent().removeClass("sidebar-registration-active");
                  $(this).parent().addClass("sidebar-registration-active");
              } else {
                  $(this).parent().removeClass("sidebar-registration-active");
              }
          });
      }
   
   
      $(document).on("scroll", Scroll_block);
   
      $(".sidebar-info a").click(function(e){
          e.preventDefault();
   
          $(document).off("scroll");
          $(".sidebar-info li.sidebar-registration-active").parent().removeClass("sidebar-registration-active");
          $(this).parent().addClass("sidebar-registration-active");
          var hash = $(this).attr("href");
          var target = $(hash);
   
          $("html, body").animate({
              scrollTop: target.offset().top
          }, 500, function(){
              window.location.hash = hash;
              $(document).on("scroll", Scroll_block);
          });
   
      });
   
  });

  $('.extend').click(function () {
    $(this).parent().parent().next().slideToggle();
    $('.filter-overlay').fadeToggle();
  });
  
  function closeSearch () {
    $('.filter-overlay').fadeOut();
    $('.extended-search').slideUp();
  }
  
  $('.tabs ul li a:not(.pop-a)').click(function () {closeSearch();});
  $('.filter-overlay').click(function () {closeSearch();});
  
  $('.filter-block input[type="submit"]').click(function (e) {
    e.preventDefault();
    closeSearch();
    $('.result-overlay').fadeIn();
    $('body').css('overflow', 'hidden');
  });
  
  $('.result .close span').click(function () {
    $('body').css('overflow', 'auto');
    $('.result-overlay').fadeOut();
  });
  
  $('.result .back a').click(function (e) {
    e.preventDefault();
    $('body').css('overflow', 'auto');
    $('.result-overlay').fadeOut();
  });
  
  if ($('*').is('script[src*="slim"]')) {
    $('.param-wrap').slimscroll({
      height: 185,
      color: '#145ce6',
      allowPageScroll: true,
      disableFadeOut: true
    });

    $('.select-city:not(.resp) .select-city-wrap, .select-hotel:not(.resp) .select-hotel-wrap, .alpha-wrap').slimscroll({
      height: 270,
      color: '#145ce6',
      allowPageScroll: true,
      disableFadeOut: true
    });
    
    $('.select-city.resp .select-city-wrap, .select-hotel.resp .select-hotel-wrap').slimscroll({
      height: 235,
      color: '#145ce6',
      allowPageScroll: true,
      disableFadeOut: true
    });
  }
  
  $('.switch .title > span.hotels').click(function () {
    $(this).parent().children('span.cities').removeClass('active');
    $(this).parent().parent().parent().children('.select-city.resp').addClass('hide').removeClass('tab-show');
    $(this).parent().parent().parent().children('.select-hotel.resp').removeClass('hide').addClass('tab-show');
    $(this).addClass('active');
  });
  
  $('.switch .title > span.cities').click(function () {
    $(this).parent().children('span.hotels').removeClass('active');
    $(this).parent().parent().parent().children('.select-city.resp').removeClass('hide').addClass('tab-show');
    $(this).parent().parent().parent().children('.select-hotel.resp').addClass('hide').removeClass('tab-show');
    $(this).addClass('active');
  });
  
  $('.other-country span').click(function () {
    var elem = $(this).parent().parent().parent();
    elem.children('.popular, .alpha').removeClass('hide');
    elem.children('.current-param, .select-city.tab-hide, .select-hotel.tab-hide, .select-wrap').addClass('hide');
  });
  
  $('a.pop-a').click(function (e) {
    e.preventDefault();
    var goal = $(this);
    while (!goal.is('.goal')) goal = goal.parent();
    goal.children('.popular, .alpha').addClass('hide');
    goal.children('.current-param, .select-city.tab-hide, .select-hotel.tab-hide, .select-wrap').removeClass('hide');
  });
  
  $('.input-wrap span.arrow').click(function () {
    var goal = $(this);
    while (!goal.is('.input-wrap')) goal = goal.parent();
    goal = goal.next();
    goal.toggleClass('hide');
    $('.overlay').css("display", "block");;
  });
  
  $('.goal .close span').click(function () {
    var goal = $(this);
    while (!goal.is('.goal')) goal = goal.parent();
    goal.toggleClass('hide');
  });

  $(document).ready(function(){
    var button = $('nav.menu li:nth-child(2)');
    var form = $('.countries');
    var overlay = $('.overlay');
    var close = $('.countries-close');

    button.click(function(){
      form.addClass("countries-header");
      overlay.css("display", "block");
    });
    close.click(function(){
      form.removeClass("countries-header");
      overlay.css("display", "none");
    });
    overlay.click(function(){
      form.removeClass("countries-header");
      overlay.css("display", "none");
    });
  });
  $(document).ready(function(){
    var button = $('.input-wrap span.arrow');
    var form = $('.countries');
    var overlay = $('.overlay');
    var close = $('.countries-close');

    button.click(function(){
      form.css("display", "block");
      overlay.css("display", "block");
    });
    close.click(function(){
      form.css("display", "none");
      overlay.css("display", "none");
    });
    overlay.click(function(){
      form.css("display", "none");
      overlay.css("display", "none");
    });
  });
});
